<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Synchronous & Asynchronous</title>
  </head>
  <body>
    <h1
      id="demo"
      style="
        background-color: black;
        display: inline-block;
        height: 100px;
        width: 140px;
        text-align: center;
        line-height: 100px;
        border: 2px solid rgb(218, 17, 17);
        color: whitesmoke;
        border-radius: 15px;
      "
    ></h1>

    <script>
      document.write("<h1 style = 'font-family : calibri ; color : blue'> Synchronous & Asynchronous </h1>", "<br>");

      document.write("In JavaScript, synchronous and asynchronous refer to the way in which code is executed.", "<br>");
      document.write(
        "synchronous code will block further execution of the remaining code until it finishes the current one, whereas the Asynchronous code allows the program to be executed immediately.",
        "<br>"
      );
      //Synchronous Code

      function synchronous() {
        console.log("Step 1");
        console.log("Step 2");
        console.log("Step 3");
      }
      synchronous();

      // Asynchronous

      function asynchronous() {
        console.log("Step 1");
        setTimeout(() => {
          console.log("Step 2 (delayed)");
        }, 3000); // Executes after 3 second
        console.log("Step 3");
      }
      asynchronous();

      // Synchronous is below
      document.write("Start", "<br>");
      document.write("Middle", "<br>");
      document.write("End", "<br>");

      document.write("<br>", "<br>");

      document.write("Asynchronous operations use mechanisms like callbacks, Promises, and async/await.", "<br>");

      document.write(" <h2> difference between setTimeout and setInterval </h2>");
      document.write(
        "The key difference between setTimeout and setInterval in JavaScript lies in how they execute code after a certain amount of time:",
        "<br>"
      );

      document.write("<h1> setTimeout </h1> ");
      document.write(
        "Purpose: Executes a function once after a specified delay. <br>\
                      Usage: When you need a function to run once after a certain amount of time.",
        "<br>"
      );
      // Syntax
      // setTimeout(function, delay);

      //  setTimeout( function(){
      //     alert("Hello eveyOne")
      //  },4000);

      document.write("<br>");
      document.write("<h1> setInterval </h1> ");
      document.write(
        "Purpose: Executes a function repeatedly at specified intervals of time.<br>\
                                      Usage: When you need a function to run multiple times with a fixed time gap.",
        "<br>"
      );

      //Asynchronous is below

      // Syntax for setTimeout is ; setTimeout(function, milliseconds)
      // document.write("Start", "<br>");
      // setTimeout(function () {
      //   window.alert("You are Welcome !"); // 3 seconds time have been given to this function for execution.
      // }, 3000);

      document.write("Wait just for 3 seconds" + "<br>");

      document.write("Show the time after 3 seconds", "<br>");

      document.write("<p id = 'idOne'> Here time is</p>");

      setTimeout(function () {
        // Create a new Date object
        var currentDate = new Date();
        //Get the current time using getHours, getMinutes, and getSeconds
        var hours = currentDate.getHours();
        var minutes = currentDate.getMinutes();
        var seconds = currentDate.getSeconds();
        //Print the formatted time
        document.getElementById("idOne").innerHTML = ` ${hours}:${minutes}:${seconds}`;
      }, 3000);

      function myFunction() {
        let d = new Date();
        document.getElementById("demo").innerHTML = d.getHours() + ":" + d.getMinutes() + ":" + d.getSeconds();
      }
      setInterval(myFunction, 1000);

      document.write("<br><br>");

      document.write(" <h1> JS Promises,,... Visit jsFunCallback file </h1> ");

      document.write("<b> Async & Await </b>", "<br>");
      document.write("async makes a function return a Promise.await makes a function wait for a Promise.", "<br>");
      document.write(
        "The JavaScript functions defined with the async/await keyword can perform the same task as promises with fewer lines of code, and it makes the code readable. The promise's syntax is a bit complex, so the async/await syntax is introduced.",
        "<br>"
      );
      document.write(
        "The await keyword makes JavaScript to wait for the promise to resolve before continuing the function.",
        "<br>"
      );
      document.write(
        "To use async/await, we need to define an aync function first. For this we write async before function definition. An async function returns a promise. The await keyword is used inside an async function only. ",
        "<br>"
      );
      document.write(
        "<b> async </b> is like a normal function , but we just write 'async' before this function. The difference between a normal and async function is that , an async function returns a promise",
        "<br>"
      );
      document.write(
        "A JavaScript function defined with the async keyword is called the asynchronous function. The async function allows you to produce the asynchronous code.",
        "<br>"
      );
      document.write(
        "Async  work same as 'Promise', Now the <b> question </b> is this that if we can do the same thing with promise , then why do we need async and await.",
        "<br>"
      );
      document.write(
        "The <b> answer </b> is that in 'Promise' we had to declare resolve and reject methods ( functions ), and then on the basis of these, then() and catch() were called. but in async function we don't need this, so it's easy to write (make) and read.  ",
        "<br>"
      );

      //       async function printMessage() {
      //    return "Hello World";
      // }
      // The below code is similar to the above code.
      // function printMessage() {
      //    return Promise.resolve("Hello World");
      // }

      // Normal function is below

      //  function normal(){
      //     return "Hello";
      //  }
      //  console.log(normal());

      document.write("Below is async function. Write <b>async </b> before a function.", "<br>");

      // async function normal(){   // Now it returns a promise and the value both and it has become a promise function.
      //     return "Hello";
      //  }
      //  console.log(normal());

      document.write(
        "Now I can directly call then() and catch() without declaring resolve() and reject(), as below",
        "<br>"
      );

      async function normal() {
        return "Hello from an async function";
      }
      normal().then((result) => {
        // The value of the async function is now store in the variable(parameter) of the then() function.
        document.write(result, "<br>");
      });

      // document.write(result); // If you call document.write() after the page has loaded, it overwrites the entire document, removing all existing content.
      document.write(
        "<b> Note that </b> This is not the only way of making an async function, but there are other ways too, as below.",
        "<br>"
      );
      document.write("Store an async function in a variable, as", "<br>");

      let noramll = async function () {
        return "Hi";
      };
      noramll().then((resulti) => {
        // The value of the async function is now store in the variable(parameter) of the then() function.
        console.log(resulti, "<br>");
      });

      document.write("We can even convert this function to an arrow function, as", "<br>");

      let norm = async () => "Good Morning"; // If there is a single statement, we don't nedd curly braces and return word in an arrow function.

      norm().then((resultii) => {
        // The value of the async function is now store in the variable(parameter) of the then() function.
        console.log(resultii, "<br>");
      });

      //document.write("<b> Await </b>" , "<br>")

      // async function func_name(parameters) {
      //    await promise;
      // Function body
      //}
      document.write("await makes a function wait for a Promise", "<br>");
      document.write(
        "The await keyword can only be used inside an async function. i.e , It works only inside an async function.",
        "<br>"
      );
      document.write(
        "The await keyword makes the function pause the execution and wait for a resolved promise before it continues:",
        "<br>"
      );

      async function awet() {
        console.log("2 : Message");
        await console.log(" 3 : Message is awaiting "); // Code after this line will be printed later.
        console.log("4 : Message");
      }
      console.log("1 : Message");
      awet();
      console.log("5 : Message");

      document.write("<br>");
      document.write("<br>");

      async function solvePromise() {
        const promise = new Promise((resolve, reject) => {
          setTimeout(() => {
            // Setting up timeout for promises
            resolve("The promise is solved after 2 seconds");
          }, 2000);
        });
        const isResult = await promise;
        alert(isResult);
      }
      solvePromise();

      document.write("<b style = 'color : blue ' > Fetch API </b> ", "<br>");
      document.write(
        "The Fetch API interface allows web browser to make HTTP requests to web servers. <b> Note that </b> No need for XMLHttpRequest anymore as XMLHTTpRequest requires extra coding. ",
        "<br>"
      );
      document.write(" To avoid all the problems above, we use 'fetch' method.", "<br>");
      document.write(
        "We can do anything with the server with the help of fetch method. i.e we can insert , update , read or delete the data from the server. The fetch method, as compared to AJAX or XMLHTTpRequest, requires minimum code",
        "<br>"
      );
      document.write(" <b> Sytax </b>", "<br>");
      document.write(
        " Write fetch(), and give the path of the file in the brackets, as fetch(file/URL). It could be any type of file, i.e JSON, text or PHP.",
        "<br>"
      );
      document.write(
        " fetch method basically returns a promise and as we know that we use 'then' with the promise if it is fulfilled, we also use then here , fetch(file / URL ).then(). This then also returns a promise where we make a function and in this function, we receive a response from a server, as  fetch(file / URL).then(function(response){ return response.data;}) . The data could be in any format, and we will write the name of the format here . this data will again be store in another the."
      );
      document.write(" IN case of any error , we will use catch() method.", "<br>");
      document.write("Read a text from a text file", "<br>");

      //  fetch("javascript/javasynctext.txt")
      //  .then((response)=>{
      //       return response.text();
      //  })
      //  .then((date)=>{
      //    console.log(date);
      //  });
      document.write(
        "I don't need return and curly braces as my code contains one single statement, and I can write as below.",
        "<br>"
      );
      //  fetch("javascript/javasynctext.txt")
      //  .then((response) => response.text())
      //  .then((date) => console.log(date));
      document.write(" If we pass a single parameter, I don't even need brackets around parameter.", "<br>");
      fetch("javascript/javasynctext.txt")
        .then((response) => response.text())
        .then((date) => console.log(date));

      document.write("Now I want a 'JSON' data. I take this from google, just for practice purpose.", "<br>");

      fetch("https://jsonplaceholder.typicode.com/users")
        .then((jayson) => jayson.json())
        .then((dta2) => console.log(dta2));

      document.write(
        "If I want to print the above data in document.write, i will use loops, like for..in or for..of etc , as below.",
        "<br>"
      );
      //  fetch("https://jsonplaceholder.typicode.com/users")
      //  .then((jayson) => jayson.json())
      //  .then((dta2) => {console.log(dta2);
      //  for(let x in dta2){
      //  document.write(`${dta2[x].name} -------- ${dta2[x].email} ---${dta2[x].address.city}  <br> `)}
      //  })

      document.write(
        "Sometimes the file may not be found , the path may be wrong or the server may not respond, so we use the catch() method for this , as follows.",
        "<br>"
      );

      fetch("https://jsonplaceholder.typicode.com/use")
        .then((jayson) => jayson.json1()) // I used '1' with json
        .then((dta2) => console.log(dta2))
        .catch((error) => console.log("Please put the correct name of the format (json) " + "<br>"));

      document.write(
        "Till now I just knew how to read a data. Now I will do How to save (read, delete, update etc) a data on 'server'. ",
        " <br> "
      );
      document.write(
        "we will use fetch(file/ URL,{}); (In URl ,we will give the path of the file , where we want to insert the date), In the curly braces, i will use the different properties of fetch, such metod, body etc",
        "<br>"
      );
      document.write(
        " In method property we then use different value, like 'Post' (for Inserting) , 'Delete or Get' ( for deleting) , 'Put' ( Updating) ",
        "<br>"
      );
      document.write(
        " In body we pass the data which has to be inserted on the server.It could be in any format , like ' Form Date ' , ' JSON Data ' , Text ",
        "<br>"
      );
      document.write(
        "In header we will use show the type of content such as , header:{'content-Type' : 'application/json' OR header:{'content-Type' : 'application/x-www-form-urlencoded' }",
        "<br>"
      );

      fetch("https://jsonplaceholder.typicode.com/posts", {
        method: "POST",
        body: JSON.stringify({
          //stringfy converts json format to string as body here is an object and I can't directly send an object anywhere
          title: "foo",
          body: "bar",
          userId: 1,
        }),
        headers: {
          "Content-type": "application/json; charset=UTF-8",
        },
      })
        .then((response) => response.json())
        .then((json) => console.log(json));

      async function asyncFun() {
        console.log("Wait for the data...");
        try {
          let response = await fetch("jsTry.txt");
          let data = await response.text();
          console.log(data);
        } catch (error) {
          console.error("Error fetching the file:", error);
        }
      }
      // Call the function
      asyncFun();

      document.write(
        " In the above code , The .text() method comes from the Response object returned by the fetch() API."
      );
      document.write(
        "When you use fetch(jsTry.txt), it makes an HTTP request and returns a Response object, which contains methods to extract the data in different formats."
      );

      //       Key Methods of Response Object:
      // Method	Description
      // response.text()	Reads the response as plain text (.txt, .html, etc.).
      // response.json()	Parses the response as JSON (.json files or API responses).
      // response.blob()	Reads the response as binary large object (useful for images/files).
      // response.arrayBuffer()	Reads the response as raw binary data.
    </script>
  </body>
</html>
